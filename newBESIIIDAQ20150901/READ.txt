2006-12-12 21:24 完成新状态机的修改，目前各系统都已经添加进去，MDC正常取数测试工作正常！其他系统待测！
	主要所做的修改：
		①
	备份2006-12-13 16：30

2007-03-28---04-03 针对性实现新的报错方式，主要是缓存发送方式，以1秒为周期，一秒内至多发送10个不同的错误。
	对EMC系统和MDC系统都做了修改，功能实现以当前宇宙线实验实现为基础。
	EMC系统在当前测试机箱上测试工作正常，未做大的变动
	MDC系统做了一些变动，主要如下：
		1 所有报错方式均改为当前实现方式
		2 baseline方式实现，修改为向上发送的数据结构与CALIB方式类似，运行方式与正常取数类似，需补充文档，datapackcore 与calib方式有一些不同，如所发送的ROD头填的事例号，0xff000000+(g_nMCCT0Latency<<16)/*+DAC*/ 标示，因为baseline方式下设DAC=0；
		3 修改WAVE取数实现，主要是通过修改上传的数据结构来简化程序实现。
		4 硬件配置过程实现为单步并行，多步串行方式
		5 修改了刻度时使用的g_nMCCT0Latency，g_nMQTDAC名称定义，主要是希望在其他模式配置过程中也可以使用这两个变量，避免混淆。
		6 更新层丝转换数组的初始化
		7 MQT配置过程中g_MDCDBInfo.mqt_header[nMQTIdx]->controlregister_l 主要是nSubBoardQBaseline与CBLT register 1（MQT组装数据方式）设定值的组合
		8 为支持stop之后直接start保证事例号不出错，在PREP时对MQT及MCCC插件记数器清零。
		需进一步测试。
		9 用UDP方式监视PPC的代码部分也已添加。

2007-04-04 基于新的状态机，新的报错系统在EMC系统做调试，改动如下：
		1 修改部分socket接收信息时判断的逻辑错误，主要是修改后（！=）（ ==）逻辑不够明确，问题解决
		2 向上层发送的状态及错误信息结构体添加结构体长度信息，主要是方便上层接收结构体。
		3 由于系统在waiting 状态时已经启动状态及错误发送程序，在running之前，系统状态的发送意义不很大，因此
		添加g_bStatusSend变量，系统在PREP时，设为TRUE，允许系统发送系统状态数据，当为STOP时，设为FALSE，禁		止系统状态信息的发送。
		4 在网络发送最后一个特殊事例之后，发送最终状态信息，主要是中断数及发送的事例数。
		5 上层解析程序已经添加至运行系统，测试工作正常。

2007-04-11 修改UDP服务的监视端IP地址，同时将监视端的IP设置改为从启动脚本通过参数设置。

2007-04-13 修改EMC系统，stop之后直接start事例出错的问题，主要是事例号软件记录清零，插件事例号及残存事例未清除。
		通过查插件参数文档，在PREP时添加RESET清除Q插件事例号以及ROC，MONITOR插件记录号清楚，但需要注意
		reset和配置需要特别注意延时，否则出错！

2007-06-05 该修改测试版用于MDC与trg系统宇宙线联调

2007-07-01 将数据发送socket设为非阻塞方式，发送过程中使用select实现，同时支持修改TCPPCB模块指向的定时器修改。

2007-07-03 为做EMC系统刻度修改程序，主要是相关case跳转，组装程序未完成。

2007-07-10 完成EMC系统刻度，以及MDC各模式数据组装程序的统一，通过层丝转换表的不同对应各模式组装

2007-07-13 MDC系统各模式在新状态机统一测试运行，调试后各模式能正常工作。EMC系统也已经完成刻度测试，但是发现运行有问题。

2007-08-01 MDC系统做综合功能测试，运行正常，EMC系统测试运行正常,问题解决。对系统特定功能做部分模块化修改。TOF系统测试运行前版本。

2007-08-04 TOF系统的一系列修改，配置信息修改，已经INL映射表修改。TOF系统各模式运行正常。

2007-08-09 系统做较为大的变动，主要是配置信息的结构体做32位存储处理，以保证可扩展性，通用性等。

2007-08-10 主要对该版本做了数据类型扩展，各系统刻度模式传值按UINT处理。主要修改了以下几个配置信息。
		crate header结构体定义修改，原来的run_times_l,run_times_h,由一个unsigned int	run_times;代替

		struct GE_ppc	PPC配置结构体定义
			unsigned int	ROS_ip;
			unsigned int	ROS_port;
			unsigned int	unused;	
		将原来ROS_ip_h 和ROS_ip_l 由一个int 型的 ROS_ip

		MDC MQT配置信息修改
			将原来controlregister_l controlregister_h由一个
			unsigned int	controlregister；取代
			增加unsigned int	QT_hit_option;变量定义，主要是QT多次击中设置，这两个参数以前由controlregister_l拼成
			最高位 表示 台阶值扣除与否，低8位表示QT击中设置，定义修改后需要注意。
		
			T_modules_Enable_l,T_modules_Enable_h,改为unsigned int	T_modules_Enable;程序也做相应修改。

2007-08-15 主要调试TOF系统各模式，PPC配置信息中添加NormModeSelfL1项，主要实现正常取数模式下自发L1测试。
		TOF FEE插件配置信息修改 workmode 为 barrel_end，该变量用于区分FEE插件对应桶部或端盖。目前正常取数模式工作正常。
		从今天开始，16位配置信息版本废弃。

2007-09-12 此阶段做trg系统与EMC系统联调，主要是发现一系列两个系统在正常取数工作模式下所发现的问题并解决。
	   目前该程序在两个联调系统上能比较正常的工作，EMC系统自己发L1，工作频率800HZ左右工作正常（过程中发现TRG系统有插件数据满
		的情况，并停止工作，后解决），TRG系统自己模拟发L1能正常工作在4kHZ左右，不能再提高的原因为TRG系统数据满（期间发现
		插拔插销会造成整体系统工作不正常）

2007-09-13 jixl将muon系统测试程序覆盖到EMC与TRG系统联调版本中，做版本整合！未做运行测试，编译通过。

2007-09-29 与muon系统在工地调试之后能正常运行版本，编译通过，测试通过

2007-10-04 完成PPC状态显示程序到online程序的嵌入，基本工作正常。
	   完成并测试通过上层shutdown的时候，PPC不做重启，而只是软件重启。
2007-10-05 解决不重启PPC，只重启读出程序造成的内存泄露

2007-10-06 在EMC数据组装程序中加事例数据矫正功能，测试添加功能后增加的CPU负载！

2007-10-10 解决PPC不重启，只启动读出程序，解决内存泄露问题。

2007-10-24 trig单系统测试已经正常。

2007-11-02 trig增加了数据触发号的检查。调整了配置上的一些步骤顺序。trig和EMC联调在一次一个中断情况下已经能够正常工作。

2007-11-06 TOF系统测试通过monitor模式，自检模式. EMC与trg系统联合测试，测试加事例矫正之后的系统工作性能。

2007-11-26 emc trg系统联合调试

2007-11-29 对ringbuf申请和writen操作之间做长度check。对上报状态的任务中打印信息的flag进行初始化。对TRG系统的任务做退出时任务号赋0。

2007-12-03 将TRG系统的每事例多中断数据组装整合至读出程序，未做功能正确性测试。
	将各子系统的InitialEXIT函数与框架的AnyEXIT对应，各子系统单独启动的任务由各子系统自己维护，上层给shutdown的时候做整个任务和参数的释放。
	对于Shutdown时的处理，如果删除过程中出错，则直接自动重启PPC，并必须发送succ给上层，否则可能会造成上层停止过程有问题。
	
2008-01-03 增加TRG系统的MUTL,MUDT插件的配置。测试通过。

2008-01-30 报错信息重新核对。

2008-02-22 TRG系统TDC插件的配置核对完成


2008-07-24 EMC monitor模式取数基本完成。

















		